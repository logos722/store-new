/**
 * Список крупных городов России для автокомплита
 * Отсортирован по убыванию населения для лучшего UX
 */

export interface City {
  name: string;
  region: string;
}

/**
 * Основной список российских городов
 * Включает города с населением более 100 000 человек
 */
export const RUSSIAN_CITIES: readonly City[] = [
  { name: 'Москва', region: 'Москва' },
  { name: 'Санкт-Петербург', region: 'Санкт-Петербург' },
  { name: 'Новосибирск', region: 'Новосибирская область' },
  { name: 'Екатеринбург', region: 'Свердловская область' },
  { name: 'Казань', region: 'Республика Татарстан' },
  { name: 'Нижний Новгород', region: 'Нижегородская область' },
  { name: 'Челябинск', region: 'Челябинская область' },
  { name: 'Самара', region: 'Самарская область' },
  { name: 'Омск', region: 'Омская область' },
  { name: 'Ростов-на-Дону', region: 'Ростовская область' },
  { name: 'Уфа', region: 'Республика Башкортостан' },
  { name: 'Красноярск', region: 'Красноярский край' },
  { name: 'Воронеж', region: 'Воронежская область' },
  { name: 'Пермь', region: 'Пермский край' },
  { name: 'Волгоград', region: 'Волгоградская область' },
  { name: 'Краснодар', region: 'Краснодарский край' },
  { name: 'Саратов', region: 'Саратовская область' },
  { name: 'Тюмень', region: 'Тюменская область' },
  { name: 'Тольятти', region: 'Самарская область' },
  { name: 'Ижевск', region: 'Удмуртская Республика' },
  { name: 'Барнаул', region: 'Алтайский край' },
  { name: 'Ульяновск', region: 'Ульяновская область' },
  { name: 'Иркутск', region: 'Иркутская область' },
  { name: 'Хабаровск', region: 'Хабаровский край' },
  { name: 'Ярославль', region: 'Ярославская область' },
  { name: 'Владивосток', region: 'Приморский край' },
  { name: 'Махачкала', region: 'Республика Дагестан' },
  { name: 'Томск', region: 'Томская область' },
  { name: 'Оренбург', region: 'Оренбургская область' },
  { name: 'Кемерово', region: 'Кемеровская область' },
  { name: 'Новокузнецк', region: 'Кемеровская область' },
  { name: 'Рязань', region: 'Рязанская область' },
  { name: 'Набережные Челны', region: 'Республика Татарстан' },
  { name: 'Астрахань', region: 'Астраханская область' },
  { name: 'Пенза', region: 'Пензенская область' },
  { name: 'Киров', region: 'Кировская область' },
  { name: 'Липецк', region: 'Липецкая область' },
  { name: 'Балашиха', region: 'Московская область' },
  { name: 'Чебоксары', region: 'Чувашская Республика' },
  { name: 'Калининград', region: 'Калининградская область' },
  { name: 'Тула', region: 'Тульская область' },
  { name: 'Курск', region: 'Курская область' },
  { name: 'Ставрополь', region: 'Ставропольский край' },
  { name: 'Севастополь', region: 'Севастополь' },
  { name: 'Сочи', region: 'Краснодарский край' },
  { name: 'Улан-Удэ', region: 'Республика Бурятия' },
  { name: 'Тверь', region: 'Тверская область' },
  { name: 'Магнитогорск', region: 'Челябинская область' },
  { name: 'Иваново', region: 'Ивановская область' },
  { name: 'Брянск', region: 'Брянская область' },
  { name: 'Белгород', region: 'Белгородская область' },
  { name: 'Сургут', region: 'Ханты-Мансийский АО' },
  { name: 'Владимир', region: 'Владимирская область' },
  { name: 'Нижний Тагил', region: 'Свердловская область' },
  { name: 'Архангельск', region: 'Архангельская область' },
  { name: 'Чита', region: 'Забайкальский край' },
  { name: 'Калуга', region: 'Калужская область' },
  { name: 'Смоленск', region: 'Смоленская область' },
  { name: 'Волжский', region: 'Волгоградская область' },
  { name: 'Курган', region: 'Курганская область' },
  { name: 'Орёл', region: 'Орловская область' },
  { name: 'Череповец', region: 'Вологодская область' },
  { name: 'Вологда', region: 'Вологодская область' },
  { name: 'Владикавказ', region: 'Республика Северная Осетия' },
  { name: 'Мурманск', region: 'Мурманская область' },
  { name: 'Саранск', region: 'Республика Мордовия' },
  { name: 'Якутск', region: 'Республика Саха (Якутия)' },
  { name: 'Тамбов', region: 'Тамбовская область' },
  { name: 'Грозный', region: 'Чеченская Республика' },
  { name: 'Стерлитамак', region: 'Республика Башкортостан' },
  { name: 'Кострома', region: 'Костромская область' },
  { name: 'Петрозаводск', region: 'Республика Карелия' },
  { name: 'Нижневартовск', region: 'Ханты-Мансийский АО' },
  { name: 'Йошкар-Ола', region: 'Республика Марий Эл' },
  { name: 'Новороссийск', region: 'Краснодарский край' },
  { name: 'Химки', region: 'Московская область' },
  { name: 'Таганрог', region: 'Ростовская область' },
  { name: 'Комсомольск-на-Амуре', region: 'Хабаровский край' },
  { name: 'Сыктывкар', region: 'Республика Коми' },
  { name: 'Нижнекамск', region: 'Республика Татарстан' },
  { name: 'Братск', region: 'Иркутская область' },
  { name: 'Дзержинск', region: 'Нижегородская область' },
  { name: 'Орск', region: 'Оренбургская область' },
  { name: 'Ангарск', region: 'Иркутская область' },
  { name: 'Шахты', region: 'Ростовская область' },
  { name: 'Благовещенск', region: 'Амурская область' },
  { name: 'Великий Новгород', region: 'Новгородская область' },
  { name: 'Псков', region: 'Псковская область' },
  { name: 'Бийск', region: 'Алтайский край' },
  { name: 'Прокопьевск', region: 'Кемеровская область' },
  { name: 'Рыбинск', region: 'Ярославская область' },
  { name: 'Балаково', region: 'Саратовская область' },
  { name: 'Армавир', region: 'Краснодарский край' },
  { name: 'Северодвинск', region: 'Архангельская область' },
  { name: 'Подольск', region: 'Московская область' },
  { name: 'Королёв', region: 'Московская область' },
  { name: 'Мытищи', region: 'Московская область' },
  { name: 'Люберцы', region: 'Московская область' },
  { name: 'Петропавловск-Камчатский', region: 'Камчатский край' },
  { name: 'Норильск', region: 'Красноярский край' },
  { name: 'Южно-Сахалинск', region: 'Сахалинская область' },
] as const;

/**
 * Фильтрует города по введенному запросу
 * Поиск выполняется по началу названия города (регистронезависимо)
 *
 * @param query - Поисковый запрос
 * @param maxResults - Максимальное количество результатов (по умолчанию 10)
 * @returns Массив подходящих городов
 */
export function filterCities(query: string, maxResults: number = 10): City[] {
  if (!query || query.trim().length === 0) {
    return [];
  }

  const normalizedQuery = query.trim().toLowerCase();

  return RUSSIAN_CITIES.filter(city =>
    city.name.toLowerCase().startsWith(normalizedQuery),
  ).slice(0, maxResults);
}

/**
 * Получает список всех названий городов для быстрой проверки
 * @returns Массив названий городов
 */
export function getCityNames(): string[] {
  return RUSSIAN_CITIES.map(city => city.name);
}

/**
 * Проверяет, существует ли город в списке
 * @param cityName - Название города для проверки
 * @returns true если город найден в списке
 */
export function isCityValid(cityName: string): boolean {
  if (!cityName || cityName.trim().length === 0) {
    return false;
  }

  const normalizedName = cityName.trim().toLowerCase();

  return RUSSIAN_CITIES.some(
    city => city.name.toLowerCase() === normalizedName,
  );
}
